<!DOCTYPE html>
<html>
    <head>
            {{"decoupled-map"|googlemap_js(37.4419, -122.1419, markers=[(37.4419, -122.1419)])}}
            {{mymap.js}}
            {{sndmap.js}}
    </head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type=text/javascript>

    console.log('beignning of script')
        var source = new EventSource('127.0.0.1:5000/stream');
        source.onmessage = function (event) {
            console.log(event.data);
            console.log(event);
             alert(event.data);
        };


      var socket = io.connect('http://' + document.domain + ':' + location.port);


        socket.on('connect', function() {           
            console.log('socket connected');
        });

        // socket.on('somerandomevent', function(msg) {
        //     console.log("123");
        //     console.log(msg);
        //     $('#log').append('<p>Received: ' + msg.data + '</p>');
        //     socket.emit('my event', {data: 'I\'m connected!'});
        // });

        socket.on('my response', function(msg) {
            console.log("my response");
            console.log(msg);
            $('#log').append('<p>Received: ' + msg.data + '</p>');
            socket.emit('my event', {data: 'I\'m connected!'});
        });



    // socket.on('my event', function(data){ console.log(data);});

    </script>
    <script type="text/javascript" charset="utf-8">


    // $(document).ready(function(){
    //     // console.log('http://' + document.domain + ':' + location.port + '/test');
    //     var socket = io.connect('http://' + document.domain + ':' + location.port + '/test');

    //     console.log(socket);

    //     socket.on('my response', function(msg) {
    //         $('#log').append('<p>Received: ' + msg + '</p>');
    //         console.log(msg);
    //     });


    //     $('form#emit').submit(function(event) {
    //         socket.emit('my event', {data: $('#emit_data').val()});
    //         return false;
    //     });
    //     $('form#broadcast').submit(function(event) {
    //         socket.emit('my broadcast event', {data: $('#broadcast_data').val()});
    //         return false;
    //     });
    // });

    // var someJavaScriptVar = '{{ geocode[0] }}';
    // var someJavaScriptVar_2 = '{{ geocode[1] }}';
    // alert(someJavaScriptVar,someJavaScriptVar_2);
    </script>
    
    <body>
        <button onclick="alert('Geocode: {{ geocode[0] }} {{geocode[1]}} ' )" />
        <h1 id="tit">Flask Google Maps Example</h1>
        <div id="log"> hello how are you</div> 
        <h2> Template function with multiple markers </h2>
        {% with map=googlemap_obj("another-map", 37.4419, -122.1419, markers=[(37.4419, -122.1419), (37.4300, -122.1400)]) %}
            {{map.html}}
            {{map.js}}
        {% endwith %}

        <!--
        <h2> Template function centered, no marker </h2>
        {{googlemap("simple-map", 37.4419, -122.1419)}}

        <h2> Template filter decoupled with single marker </h2>
        {{"decoupled-map"|googlemap_html(37.4419, -122.1419)}}

        <h2> First map generated in view</h2>
        {{mymap.html}}

        <h2> Second map generated in view</h2>
        <h3> Example for different icons in multiple markers</h3>
        {{sndmap.html}}
        -->
    </body>
</html>